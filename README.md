# 海龟交易法实现

这是一个完整的海龟交易法Python实现，包含策略信号生成和回测引擎。

## 文件结构

- `turtle_trading_strategy.py`: 海龟交易策略核心实现
- `turtle_backtest.py`: 回测引擎
- `main.py`: 完整示例程序
- `test_turtle.py`: 使用模拟数据的测试程序

## 策略说明

海龟交易法是趋势跟踪策略的经典代表，由理查德·丹尼斯在1980年代开发。本实现包含以下核心组件：

### 1. 入场信号
- 系统1入场：价格突破过去20天的最高点
- 系统2入场：价格突破过去55天的最高点（可选）

### 2. 出场信号
- 系统1出场：价格跌破过去10天的最低点
- 系统2出场：价格跌破过去20天的最低点（可选）

### 3. 头寸规模管理
- 使用ATR（平均真实波幅）计算头寸规模
- 每次交易风险控制在账户资金的1%以内

### 4. 止损机制
- ATR止损：当价格向不利方向移动超过2倍ATR时止损

## 使用方法

### 安装依赖
```bash
pip install pandas numpy yfinance
```

### 运行示例程序
```bash
python main.py
```

程序运行时会提示输入以下参数：
- 股票代码（例如：AAPL, GOOGL, TSLA等）
- 开始日期（格式：YYYY-MM-DD）
- 结束日期（格式：YYYY-MM-DD）
- 初始资金（直接回车使用默认值100000.0）

如果直接回车，程序将使用默认参数运行。

### 运行测试程序（无需网络）
```bash
python test_turtle.py
```

## 类说明

### TurtleTradingStrategy
核心策略类，用于生成交易信号。

参数：
- `entry_window`: 入场信号窗口（默认20天）
- `exit_window`: 出场信号窗口（默认10天）
- `atr_window`: ATR计算窗口（默认20天）
- `atr_multiplier`: ATR止损倍数（默认2.0）
- `risk_percent`: 账户风险百分比（默认0.01）

### TurtleBacktester
回测引擎类，用于策略性能评估。

参数：
- `symbol`: 交易标的代码
- `start_date`: 回测开始日期
- `end_date`: 回测结束日期
- `initial_capital`: 初始资金（默认100000.0）
- `contract_size`: 合约乘数（默认1.0）

## 注意事项

1. 本实现仅供学习和研究使用，不构成投资建议
2. 实盘交易前请进行充分测试
3. 策略参数可根据具体市场环境进行调整
